# Устранение ошибки AttributeError: 'AnonymousUserMixin' object has no attribute 'id'

## Описание проблемы
Ошибка возникает, когда неавторизованный пользователь пытается получить доступ к атрибуту `id` объекта `current_user`, который для неавторизованных пользователей является экземпляром `AnonymousUserMixin`.

## Исправления

### 1. Добавлен декоратор @login_required
- ✅ Функция `add_vacancy` теперь требует авторизации
- ✅ Все функции, использующие `current_user.id`, имеют декоратор `@login_required`

### 2. Исправлено несоответствие ролей
- ✅ Заменено 'candidate' на 'applicant' в auth.py и routes.py
- ✅ Теперь роли соответствуют форме регистрации

### 3. Добавлена обработка ошибок
- ✅ Добавлен обработчик `AttributeError` в routes.py
- ✅ Улучшена безопасность функции `vacancy_detail`
- ✅ Добавлены проверки в декоратор `owner_required`

### 4. Безопасная работа с current_user
```python
# Правильный способ проверки
if current_user.is_authenticated:
    try:
        user_id = current_user.id
        # работа с user_id
    except AttributeError:
        # обработка ошибки
```

## Проверка исправлений

1. Запустите приложение: `python run.py`
2. Попробуйте зайти на страницы без авторизации
3. Проверьте регистрацию и вход пользователей
4. Убедитесь, что роли работают корректно

## Дополнительные рекомендации

1. Всегда используйте `current_user.is_authenticated` перед обращением к `current_user.id`
2. Используйте декоратор `@login_required` для защищенных маршрутов
3. Обрабатывайте исключения при работе с `current_user`
4. Тестируйте функциональность с неавторизованными пользователями 